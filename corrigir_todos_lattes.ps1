$html = [System.IO.File]::ReadAllText('index.html', [System.Text.Encoding]::UTF8)

$mapping = @{
    "Adriana Rodrigues Mendonça" = "0530827038331816"
    "Alberto Luiz Ferreira" = "3443182824878866"
    "Alexandre Araujo Bezerra" = "5647518666766098"
    "Alexandre Manicoba De Oliveira" = "2351905355694162"
    "Aline Maria Dos Santos Teixeira" = "8589666863624180"
    "Amauri Dias De Carvalho" = "4633002288019460"
    "Ana Elisa Sobral Caetano Da Silva Ferreira" = "0322712366911621"
    "Anderson Alves De Oliveira" = "8390762794908585"
    "Antonio Cesar Lins Rodrigues" = "5364387869010471"
    "Antonio Mendes De Oliveira Neto" = "0156817167009603"
    "Aristides Faria Lopes Dos Santos" = "K4737658J8"
    "Arnaldo De Carvalho Junior" = "2801594081219451"
    "Augusto Monteiro Ozorio" = "8946741255015096"
    "Carlos Barreira Da Silva Farinhas" = "5368368699798711"
    "Carlos Jair Coletto" = "7353087112070433"
    "Caroline Alves Soler" = "5394591294622968"
    "Charles Artur Santos De Oliveira" = "7955383731847589"
    "Cristiane Ferraz E Silva Suarez" = "6072591518060376"
    "Daiane Evangelista Da Silva" = "2704540669332324"
    "Douglas Rodrigues Silva" = "9196376338221462"
    "Edmilson Roberto Braga" = "3332088975086202"
    "Eduardo Henrique Gomes" = "4447935676139776"
    "Elaine Cristina De Araujo" = "8946741255015096"
    "Elcio Rodrigues Aranha" = "6897242450860951"
    "Elian João Agnoletto" = "3278209859653249"
    "Elifas Levi Da Silva" = "5106317322513827"
    "Enzo Bertazini" = "2606617037551270"
    "Fabiana De Lacerda Vilaco" = "8088461024749919"
    "Ferdinando Calle" = "9071463080240819"
    "Fernanda Aparecida Dos Santos" = "2339710145228308"
    "Fernando Dias De Oliveira" = "0137204948070733"
    "Fernando Ribeiro Dos Santos" = "0917092323738457"
    "Filipe Bento Magalhães" = "2001123342777874"
    "Flavia Daylane Tavares De Luna" = "0322712366911621"
    "Gabriel Silva Xavier Nascimento" = "8165616867408082"
    "Giovane Marçal De Oliveira" = "8390762794908585"
    "Gisele De Gouvea" = "6003990795921040"
    "Glauber Renato Colnago" = "9876336514531357"
    "Humberto Hickel De Carvalho" = "3972633128640965"
    "Isabela Assunção De Oliveira Andrade" = "9662875113651503"
    "Ivaldo Marques Batista" = "5364387869010471"
    "Jairo Barbosa Junior" = "1088212695829506"
    "Jamielli Tomaz Pereira" = "2801594081219451"
    "Julio Cesar Zandonadi" = "3083750278254592"
    "Karina Stefânia Souza Lopes" = "7569291799926573"
    "Katya Laís Ferreira Patella Couto" = "2905730630984653"
    "Khalil Salem Sugui" = "1598677264477335"
    "Leandro Albino Mosca Rodrigues" = "5726047707894583"
    "Leonardo Matheus Marion Jorge" = "4498824812684000"
    "Luana Mara Almeida Teixeira" = "5063104922565921"
    "Lucas Kenjy Bazaglia Kuroda" = "3443182824878866"
    "Luciano André Carvalho Reis" = "2539410198240163"
    "Luiz Henrique Kiehn" = "4633002288019460"
    "Marcelo Eduardo Pereira" = "3905473334894442"
    "Marcelo Macchi Da Silva" = "5220477053711608"
    "Marcelo Pereira Bergamaschi" = "5647518666766098"
    "Marcelo Saraiva Coelho" = "4877420955045703"
    "Marciel Silva Santos" = "2351905355694162"
    "Marco Aurélio Pires Marques" = "8589666863624180"
    "Marcos Marinovic Doro" = "0461164325523457"
    "Marcos Salazar Francisco" = "8325100287493334"
    "Maria De Fátima Das Neves Moreira" = "8010842851679096"
    "Maria Jeanna Sousa Dos Santos Oliveira" = "6649796144129435"
    "Marina Duarte Gomes Silva" = "3548835386841697"
    "Marta Fernandes Garcia" = "2961411469597684"
    "Matilde Perez Quintairos" = "9782304564156617"
    "Mauricio Neves Asenjo" = "8596331354732612"
    "Natalia Salan Marpica" = "4638688296783606"
    "Nelson Da Silva Paz" = "4770016544453387"
    "Nelson Nascimento Junior" = "8499007638180773"
    "Nilce Camila De Carvalho" = "1107888000348488"
    "Paula Larangeira Garcia Martins" = "1760650391519685"
    "Paulo Bueno Guerra" = "0366317443486562"
    "Paulo Jorge De Oliveira Carvalho" = "5483359917410124"
    "Paulo Mannini" = "7188455863790975"
    "Paulo Vitor De Souza Perri" = "6598661324633248"
    "Phelippe De Aguiar Lima" = "3260574678457547"
    "Rafael Stoppa Rocha" = "4935825920838794"
    "Rebeca Previate Medina" = "1016795045258728"
    "Ricardo Sorgon Pires" = "4935340781738514"
    "Ricardo Sinigaglia Arruda" = "3915354229971189"
    "Rita De Cássia Demarchi" = "9998871144343150"
    "Roberta Silva Antunes" = "4507944299087617"
    "Rosana Núbia Sorbille" = "8520915740121883"
    "Rubens Lacerda De Sá" = "0063865672120826"
    "Sandra Regina Lima Dos Santos Silva" = "2513523808365384"
    "Sergio Arnaud Sampaio" = "7578517961831178"
    "Sérgio Henrique Rocha Batista" = "8191727568242471"
    "Solange Maria Da Silva" = "2905730630984653"
    "Sueli Maria Preda Dos Santos Torres" = "1088212695829506"
    "Thiago Rodrigues Schulze" = "4638688296783606"
    "Thiago Silva Augusto Da Fonseca" = "2896850888776619"
    "Ulisses Galvao Romao" = "8499007638180773"
    "Valderi Silveira Pinto Jr" = "9910460090402916"
    "Valeria Luiza Pereira Fedrizzi" = "7258693512438054"
    "Wellington Santos Ramos" = "2961411469597684"
    "Wellington Tuler Moraes" = "8010842851679096"
    "Artarxerxes Tiago Tácito Modesto" = "2896850888776619"
    "Claudia Cristina Soares De Carvalho" = "9910460090402916"
    "Leandro Fabricio Campelo" = "7258693512438054"
    "Leticia Vieira Oliveira Giordano" = "5592805912091990"
    "Michelli Analy de Lima Rosa" = "9354778798444061"
}

$alteradas = 0

foreach ($nome in $mapping.Keys) {
    $id = $mapping[$nome]
    if ($id -match "^K") {
        $url = "http://buscatextual.cnpq.br/buscatextual/visualizacv.do?id=$id"
    } else {
        $url = "http://lattes.cnpq.br/$id"
    }
    
    $pattern = '(data-name="' + [regex]::Escape($nome) + '"[^"]*data-lattes=")([^"]*)'
    
    if ($html -match $pattern) {
        $html = $html -replace $pattern, ('$1' + $url)
        $alteradas++
    }
}

[System.IO.File]::WriteAllText('index.html', $html, [System.Text.Encoding]::UTF8)
Write-Host "OK: $alteradas Lattes corrigidos para nomes de professores!" -ForegroundColor Green
